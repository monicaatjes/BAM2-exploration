---
title: "Reputation"
author: "Moniek"
date: "5/7/2020"
output: ingmarkdowntemplates::ing_html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Reputation

This dashboard shows reputation scores in line with what The Reputation Institure used to report for ING. Altough the same methodology is applied, it is not possible to reproduce the (pulse) scores exactly because of unknown cultural correction. The aim is to provide insights in ING's reputation, within the context of the (other) brand metrics. 

<br>


##  ![](/Users/xo21bm/Documents/Lokaal/BAM2/exploration/notebooks/aus.png) Australia

### **Overview**
  
<div class="row">
  <div class="col-md-6" markdown="1">
  
  
   **Drivers ING vs competition**
   
```{r quickAUS, echo=FALSE, echo=F, eval=T, fig.width=6.3, fig.align='left', fig.height=3}
quickfact <- test %>%
  dplyr::select(label, country, quarter_measurement, labels_quarters, pulse, rep_trak1, rep_trak2, rep_trak3, rep_trak4,
                rep_trak5, rep_trak6, rep_trak7, rep_trak8, rep_trak9, rep_trak10, rep_trak11, b_value) %>%
  dplyr::filter(country==1 & quarter_measurement==21 & b_value<6) %>%
  dplyr::mutate(
    pulse = round(pulse, digits=2),
    rep_trak5 = round(rep_trak5, digits=2),
    rep_trak6 = round(rep_trak6, digits=2),
    rep_trak7 = round(rep_trak7, digits=2),
    rep_trak8 = round(rep_trak8, digits=2),
    rep_trak9 = round(rep_trak9, digits=2),
    rep_trak10 = round(rep_trak10, digits=2),
    rep_trak11 = round(rep_trak11, digits=2),
  )

quickfactt <- as.data.frame(t(quickfact))
row.names(quickfactt) <- NULL
colnames(quickfactt) = as.character(unlist(quickfactt[1,]))
quickfactt <- quickfactt[-c(1:9, 17),]

quickfactt$ING <- as.numeric(as.character(quickfactt$ING))
quickfactt$ANZ <- as.numeric(as.character(quickfactt$ANZ))
quickfactt$Commonwealth <- as.numeric(as.character(quickfactt$Commonwealth))
quickfactt$NAB <- as.numeric(as.character(quickfactt$NAB))
quickfactt$Westpac <- as.numeric(as.character(quickfactt$Westpac))

quickfactt$Drivers <- c("Products", "Innovation", "Workplace", "Governance", "Citizenship", "Leadership", "Performance")

p <- plot_ly(
  type = 'table',
  columnwidth = c(50, 45, 45, 45, 45, 45),
  columnorder = c(0, 1, 2, 3, 4, 5),
  header = list(
    values = c("<b>Drivers<b>", "<b>ING<b>", "<b>ANZ<b>", "<b>NAB<b>","<b>Commonwealth<b>", "<b>Westpac<b>"),
    align = c("left", "right", "right", "right", "right", "right"),
    line = list(width = 1, color = c("rgb 168, 168, 168")),
    fill = list(color = c("rgb(255,098,000)", "rgb(255,098,000)", "rgb(255,098,000)", "rgb(255,098,000)", "rgb(255,098,000)",
                          "rgb(255,098,000)")),
    font = list(family = "ING me", size = 12, color = "white")
  ),
  cells = list(
    values = rbind(quickfactt$Drivers, quickfactt$ING, quickfactt$ANZ, quickfactt$NAB, 
                   quickfactt$Commonwealth, quickfactt$Westpac),
    align = c("left", "right", "right", "right", "right", "right"),
    line = list(color = c("rgb 168, 168, 168"), width = 1),
    font = list(family = "ING me", size = 12, color = c("rgb 105, 105, 105"))
  ))
p
```
 </div>
  <div class="col-md-6" markdown="1">

   **Pulse over time**
 
```{r pulse AUS, echo=FALSE, echo=F, eval=T, fig.width=5.2, fig.height=3.5, fig.align='left'}
quickfact <- test %>%
  dplyr::select(label, country, quarter_measurement, labels_quarters, pulse, rep_trak1, rep_trak2, rep_trak3, rep_trak4,
                rep_trak5, rep_trak6, rep_trak7, rep_trak8, rep_trak9, rep_trak10, rep_trak11, b_value) %>%
  dplyr::filter(country==1 & quarter_measurement>17 & b_value<6) %>%
  dplyr::mutate(
    pulse = round(pulse, digits=2),
    rep_trak5 = round(rep_trak5, digits=2),
    rep_trak6 = round(rep_trak6, digits=2),
    rep_trak7 = round(rep_trak7, digits=2),
    rep_trak8 = round(rep_trak8, digits=2),
    rep_trak9 = round(rep_trak9, digits=2),
    rep_trak10 = round(rep_trak10, digits=2),
    rep_trak11 = round(rep_trak11, digits=2),
  )
xaxis <- list(title = "",
              showline = TRUE,
              showgrid = FALSE,
              showticklabels = TRUE,
              linecolor = 'rgb(204, 204, 204)',
              linewidth = 2,
              autotick = FALSE,
              ticks = 'inside',
              tickcolor = 'rgb(204, 204, 204)',
              tickwidth = 2,
              #ticklen = 5,
              tickfont = list(family = "ING me",
                              size = 12,
                              color = 'rgb(105, 105, 105)'))
yaxis <- list(title = "",
              titlefont = list(family = "ING me",
                               size = 12,
                               color = 'rgb(105, 105, 105)'),
              showline = TRUE,
              showgrid = FALSE,
              range =c(0,100),
              showticklabels = TRUE,
              linecolor = 'rgb(204, 204, 204)',
              linewidth = 2,
              autotick = TRUE,
              #dtick = 50.000,
              ticks = 'inside',
              tickcolor = 'rgb(204, 204, 204)',
              tickwidth = 1,
              #ticklen = 1,
              tickfont = list(family = "ING me",
                              size = 12,
                              color = 'rgb(105, 105, 105)'))

p1 <- plot_ly(x = quickfact$labels_quarters[quickfact$label=="ING"]) %>%
  add_lines(y = ~quickfact$pulse[quickfact$label=="ING"], name = 'ING', type='scatter', 
            line = list(color = 'rgb(255,098,000)', type='scatter', width = 4, mode = 'lines+markers')) %>%
  add_lines(y = ~quickfact$pulse[quickfact$label=="ANZ"], name = 'ANZ', type='scatter', 
            line = list(color = 'rgb(96,166,218)', type='scatter', width = 4, mode = 'lines+markers')) %>%
  add_lines(y = ~quickfact$pulse[quickfact$label=="Commonwealth"], name = 'Commonwealth', type='scatter', 
            line = list(color = 'rgb(171,0,102)', type='scatter', width = 4, mode = 'lines+markers')) %>%
  add_lines(y = ~quickfact$pulse[quickfact$label=="NAB"], name = 'NAB', type='scatter', 
            line = list(color = 'rgb(208,217,60)', type='scatter', width = 4, mode = 'lines+markers')) %>%
  add_lines(y = ~quickfact$pulse[quickfact$label=="Westpac"], name = 'Wespac', type='scatter', 
            line = list(color = 'rgb(52,150,81)', type='scatter', width = 4, mode = 'lines+markers')) %>%
  layout(xaxis = xaxis,
         yaxis = yaxis,
         barmode = 'group', title= "",
         legend =list(font = list(family = "ING me", size = 12, color = 'rgb(105, 105, 105)')))

p1
```

 </div> <div class="row">  
</div>

### **Clients and non clients**

<div class="row">
  <div class="col-md-6" markdown="1">

   **Drivers ING clients vs non clients**
```{r split1AUS, echo=FALSE, echo=F, eval=T, fig.width=6.3, fig.align='left', fig.height=3}
split <- data1 %>%
  dplyr::select(label, country, quarter_measurement, labels_quarters, rep_trak1, rep_trak2, rep_trak3, rep_trak4, pulse, 
  rep_trak5, rep_trak6, rep_trak7, rep_trak8, rep_trak9, rep_trak10, rep_trak11, reptrak1_client, reptrak2_client,
  reptrak3_client, reptrak4_client, pulse_clients, reptrak5_client, reptrak6_client, reptrak7_client, reptrak8_client, 
  reptrak9_client, reptrak10_client, reptrak11_client, reptrak1_non_client, reptrak2_non_client, reptrak3_non_client,
  reptrak4_non_client, pulse_non_clients, reptrak5_non_client, reptrak6_non_client, reptrak7_non_client, reptrak8_non_client,
  reptrak9_non_client, reptrak10_non_client, reptrak11_non_client, b_value) %>%
  dplyr::filter(country==1 & quarter_measurement==21 & b_value==1) %>%
  dplyr::mutate(
    pulse = round(pulse, digits=2),
    rep_trak1 = round(rep_trak1, digits=2),
    rep_trak2 = round(rep_trak2, digits=2),
    rep_trak3 = round(rep_trak3, digits=2),
    rep_trak4 = round(rep_trak4, digits=2),
    rep_trak5 = round(rep_trak5, digits=2),
    rep_trak6 = round(rep_trak6, digits=2),
    rep_trak7 = round(rep_trak7, digits=2),
    rep_trak8 = round(rep_trak8, digits=2),
    rep_trak9 = round(rep_trak9, digits=2),
    rep_trak10 = round(rep_trak10, digits=2),
    rep_trak11 = round(rep_trak11, digits=2),
    pulse_clients = round(pulse_clients, digits=2),
    reptrak1_client = round(reptrak1_client, digits=2),
    reptrak2_client = round(reptrak2_client, digits=2),
    reptrak3_client = round(reptrak3_client, digits=2),
    reptrak4_client = round(reptrak4_client, digits=2),
    reptrak5_client = round(reptrak5_client, digits=2),
    reptrak6_client = round(reptrak6_client, digits=2),
    reptrak7_client = round(reptrak7_client, digits=2),
    reptrak8_client = round(reptrak8_client, digits=2),
    reptrak9_client = round(reptrak9_client, digits=2),
    reptrak10_client = round(reptrak10_client, digits=2),
    reptrak11_client = round(reptrak11_client, digits=2),
    pulse_non_clients = round(pulse_non_clients, digits=2),
    reptrak1_non_client = round(reptrak1_non_client, digits=2),
    reptrak2_non_client = round(reptrak2_non_client, digits=2),
    reptrak3_non_client = round(reptrak3_non_client, digits=2),
    reptrak4_non_client = round(reptrak4_non_client, digits=2),
    reptrak5_non_client = round(reptrak5_non_client, digits=2),
    reptrak6_non_client = round(reptrak6_non_client, digits=2),
    reptrak7_non_client = round(reptrak7_non_client, digits=2),
    reptrak8_non_client = round(reptrak8_non_client, digits=2),
    reptrak9_non_client = round(reptrak9_non_client, digits=2),
    reptrak10_non_client = round(reptrak10_non_client, digits=2),
    reptrak11_non_client = round(reptrak11_non_client, digits=2)
  )

splitINGdrivers <- split %>%
  dplyr::select(pulse, rep_trak5, rep_trak6, rep_trak7, rep_trak8, rep_trak9, rep_trak10, rep_trak11) 

splitINGdrivers <- as.data.frame(t(splitINGdrivers))
row.names(splitINGdrivers) <- NULL
splitINGdrivers$drivers <-c("Pulse", "Products", "Innovation", "Workplace", "Governance", "Citizenship", "Leadership", "Performance")
splitINGdrivers$general_pop <- as.numeric(as.character(splitINGdrivers$V1))

splitINGdrivers2 <- split %>%
  dplyr::select(pulse_clients, reptrak5_client,reptrak6_client, reptrak7_client, reptrak8_client, reptrak9_client,
                reptrak10_client, reptrak11_client) 

splitINGdrivers2 <- as.data.frame(t(splitINGdrivers2))
row.names(splitINGdrivers2) <- NULL
splitINGdrivers2$drivers <-c("Pulse", "Products", "Innovation", "Workplace", "Governance", "Citizenship", "Leadership", "Performance")
splitINGdrivers2$clients <- as.numeric(as.character(splitINGdrivers2$V1))

splitINGdrivers3 <- split %>%
  dplyr::select(pulse_non_clients, reptrak5_non_client, reptrak6_non_client, reptrak7_non_client, reptrak8_non_client,
                reptrak9_non_client, reptrak10_non_client, reptrak11_non_client) 

splitINGdrivers3 <- as.data.frame(t(splitINGdrivers3))
row.names(splitINGdrivers3) <- NULL
splitINGdrivers3$drivers <-c("Pulse", "Products", "Innovation", "Workplace", "Governance", "Citizenship", "Leadership", "Performance")
splitINGdrivers3$non_clients <- as.numeric(as.character(splitINGdrivers3$V1))

split <- cbind(splitINGdrivers, splitINGdrivers2, splitINGdrivers3)
split$V1 <- NULL
split$V1 <- NULL
split$V1 <- NULL
split$drivers <- NULL
split$drivers <- NULL

split <- split %>%
  dplyr::select(drivers, general_pop, clients, non_clients)

p <- plot_ly(
  type = 'table',
  columnwidth = c(50, 45, 45, 45),
  columnorder = c(0, 1, 2, 3),
  header = list(
    values = c("<b>Drivers<b>", "<b>general pop<b>", "<b>clients<b>", "<b>non clients<b>"),
    align = c("left", "right", "right", "right", "right"),
    line = list(width = 1, color = c("rgb 168, 168, 168")),
    fill = list(color = c("rgb(255,098,000)", "rgb(255,098,000)", "rgb(255,098,000)", "rgb(255,098,000)", "rgb(255,098,000)")),
    font = list(family = "ING me", size = 14, color = "white")
  ),
  cells = list(
    values = rbind(split$drivers, split$general_pop, split$clients, split$non_clients),
    align = c("left", "right", "right", "right"),
    line = list(color = c("rgb 168, 168, 168"), width = 1),
    font = list(family = "ING me", size = 12, color = c("rgb 105, 105, 105"))
  ))
p
```

 </div>
  <div class="col-md-6" markdown="1">

   **ING clients vs non clients**
 
```{r split AUS, echo=FALSE, echo=F, eval=T, fig.width=5.2, fig.height=3.5, fig.align='left'}

xaxis <- list(title = "",
              showline = TRUE,
              showgrid = FALSE,
              showticklabels = TRUE,
              linecolor = 'rgb(204, 204, 204)',
              linewidth = 2,
              autotick = TRUE,
              ticks = 'inside',
              tickcolor = 'rgb(204, 204, 204)',
              tickwidth = 2,
              #ticklen = 5,
              tickfont = list(family = "ING me",
                              size = 12,
                              color = 'rgb(105, 105, 105)'))
yaxis <- list(title = "",
              titlefont = list(family = "ING me",
                               size = 12,
                               color = 'rgb(105, 105, 105)'),
              showline = TRUE,
              showgrid = FALSE,
              range =c(0,100),
              showticklabels = TRUE,
              linecolor = 'rgb(204, 204, 204)',
              linewidth = 2,
              autotick = TRUE,
              #dtick = 50.000,
              ticks = 'inside',
              tickcolor = 'rgb(204, 204, 204)',
              tickwidth = 1,
              #ticklen = 1,
              tickfont = list(family = "ING me",
                              size = 12,
                              color = 'rgb(105, 105, 105)'))


p1 <- plot_ly(x = split$drivers, y=~split$clients, 
               name ='clients', type='bar', marker = list(color = 'rgb(255,098,000)', width = 4)) %>%
  add_trace(y = ~split$general_pop, 
            name = 'general pop', marker = list(color = 'rgb(96,166,218)', width = 4)) %>%
  add_trace(y = ~split$non_clients, 
            name = 'non clients', marker = list(color = 'rgb(171,0,102)', width = 4)) %>%
  layout(xaxis = xaxis,
         yaxis = yaxis,
         barmode = 'group', title= "",
         legend =list(font = list(family = "ING me", size = 12, color = 'rgb(105, 105, 105)')))
p1

```
 </div> <div class="row">  
</div>


### **Reputation and other brand metrics**

<div class="row">
  <div class="col-md-6" markdown="1">

   **Trust, Love, Pulse**
```{r trendbrandAUS, echo=FALSE, echo=F, eval=T, fig.width=5.2, fig.align='left', fig.height=3.5 }
trendbrand <- test %>%
  dplyr::select(b_value, label, quarter_measurement, country, labels_quarters, labels_countries, trust4, desirability,
                easy_mean, meets_needs_mean, smart_mean, digital_experience, pulse, love_mean_ING, price_mean) %>%
  dplyr::filter(country==1 & quarter_measurement>17 & b_value==1) %>%
  dplyr::mutate(
    trust = trust4 *100,
    love = love_mean_ING * 10
  )

p1 <- plot_ly(x = trendbrand$labels_quarters) %>%
  add_lines(y = ~trendbrand$pulse, name = 'pulse', type='scatter', 
            line = list(color = 'rgb(255,098,000)', type='scatter', width = 4, mode = 'lines+markers')) %>%
  #add_lines(y = ~trendbrand$desirability, name = 'desirability', type='scatter', 
  #          line = list(color = 'rgb(96,166,218)', type='scatter', width = 4, mode = 'lines+markers')) %>%
  add_lines(y = ~trendbrand$trust, name = 'trust', type='scatter', 
            line = list(color = 'rgb(171,0,102)', type='scatter', width = 4, mode = 'lines+markers')) %>%
  add_lines(y = ~trendbrand$love, name = 'love', type='scatter', 
            line = list(color = 'rgb(208,217,60)', type='scatter', width = 4, mode = 'lines+markers')) %>%
  layout(xaxis = xaxis,
         yaxis = yaxis,
         barmode = 'group', title= "",
         legend =list(font = list(family = "ING me", size = 12, color = 'rgb(105, 105, 105)')))

p1


```

 </div>
  <div class="col-md-6" markdown="1">

   **Pulse and Trust**
 
```{r trendbrand2AUS, echo=FALSE, echo=F, eval=T, fig.width=5.2, fig.height=3.5, fig.align='left', warning=F}

trendbrand <- test %>%
  dplyr::select(b_value, label, quarter_measurement, country, labels_quarters, labels_countries, trust4, desirability,
                easy_mean, meets_needs_mean, smart_mean, digital_experience, pulse, love_mean_ING, price_mean) %>%
  dplyr::filter(country==1 & quarter_measurement==21 & b_value <6) %>%
  dplyr::mutate(
    trust = trust4 *100,
    love = love_mean_ING * 10
  )

trendbrandp <- trendbrand %>%
  plot_ly(x = ~trust, y = ~pulse, type = 'scatter', color ='rgb(255,098,000)',
           mode = 'text+markers', text = ~label, textposition = 'middle right',
           textfont = list(family = "ING me", color = 'rgb(105, 105, 105)', size = 11)) %>%
  layout(title = '',
         xaxis = xaxis,
         yaxis = yaxis)
trendbrandp


```

 </div> <div class="row">  
</div>

### **Relations with pulse **
  
<div class="row">
  <div class="col-md-6" markdown="1">
  
  
   **Correlations**
   
```{r CORAUS, echo=FALSE, echo=F, eval=T, fig.width=6.3, fig.align='left', fig.height=3}

trial <- result %>%
  dplyr::select(country, quarter_measurement, weight, b_value, Love_ING, desirability_value, price_perception_value,
                easy_value, smart_value, meets_needs_value, reptrak1_value, reptrak2_value, reptrak3_value, reptrak4_value,
                reptrak5_value, reptrak6_value, reptrak7_value, reptrak8_value, reptrak9_value, reptrak10_value,
                reptrak11_value) %>%
  dplyr::filter(quarter_measurement == max(quarter_measurement)) %>%
  dplyr::filter(country==1 & b_value<6 & !is.na(reptrak1_value) & !is.na(reptrak11_value) & !is.na(desirability_value)) %>%
  dplyr::mutate(
   reptrak1 = (reptrak1_value * weight)/7 *100,
   reptrak2 = (reptrak2_value * weight)/7 *100,
   reptrak3 = (reptrak3_value * weight)/7 *100,
   reptrak4 = (reptrak4_value * weight)/7 *100,
   reptrak5 = (reptrak5_value * weight)/7 *100,
   reptrak6 = (reptrak6_value * weight)/7 *100,
   reptrak7 = (reptrak7_value * weight)/7 *100,
   reptrak8 = (reptrak8_value * weight)/7 *100,
   reptrak9 = (reptrak9_value * weight)/7 *100,
   reptrak10 = (reptrak10_value * weight)/7 *100,
   reptrak11 = (reptrak11_value * weight)/7 *100
  ) %>%
  dplyr::select(reptrak1, reptrak2, reptrak3, reptrak4, reptrak5, reptrak6, reptrak7, reptrak8, reptrak9,
                reptrak10, reptrak11, Love_ING, desirability_value, price_perception_value, easy_value, smart_value,
                meets_needs_value) %>%
  dplyr::mutate(
    pulse = reptrak1 + reptrak2 + reptrak3 + reptrak4
  ) %>%
   dplyr::select(pulse, reptrak5, reptrak6, reptrak7, reptrak8, reptrak9, reptrak10, reptrak11, Love_ING, 
                 desirability_value, price_perception_value, easy_value, smart_value, meets_needs_value)

trialcor <- trial %>%
  correlate() %>% 
  fashion() %>%
  dplyr::select(rowname, pulse) 
  trialcor$drivers <-trialcor$rowname
  trialcor$rowname <- NULL

p2 <- plot_ly(
  type = 'table',
  columnwidth = c(50, 45),
  columnorder = c(0, 1),
  header = list(
    values = c("<b>Drivers<b>", "<b>correlation pulse<b>"),
    align = c("left", "right"),
    line = list(width = 1, color = c("rgb 168, 168, 168")),
    fill = list(color = c("rgb(255,098,000)", "rgb(255,098,000)")),
    font = list(family = "ING me", size = 14, color = "white")
  ),
  cells = list(
    values = rbind(trialcor$drivers, trialcor$pulse),
    align = c("left", "right"),
    line = list(color = c("rgb 168, 168, 168"), width = 1),
    font = list(family = "ING me", size = 12, color = c("rgb 105, 105, 105"))
  ))
p2

```
 </div>
  <div class="col-md-6" markdown="1">

   **Pulse over time**
 
```{r pulse AUS, echo=FALSE, echo=F, eval=T, fig.width=5.2, fig.height=3.5, fig.align='left'}

```

 </div> <div class="row">  
</div>
